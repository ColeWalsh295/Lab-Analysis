labeller = as_labeller(c(one = "Weighted density (minutes)",
two = "Weighted density (count)"))) +
#facet_wrap(~variable, scales = 'free',
#labeller = labeller(variable = c('density' = 'Unweighted',
#'density.weighted' = 'Weighted'))) +
labs(x = 'Lab week') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00'),
labels = c('Scan', 'Skip')) +
scale_shape_manual(name = 'Lab session', values = c(16, 15)) +
theme(
strip.background = element_blank(),
#strip.text.x = element_blank()
strip.placement = "outside"
) +
ylab(NULL) +
theme(legend.position = "bottom")
legend <- get_legend(plot.weight)
plot.weight <- plot.weight + theme(legend.position = "none")
grid.arrange(plot.unweight, plot.weight, legend, layout_matrix = rbind(c(1, 2), c(3, 3)),
widths = c(2.7, 2.7), heights = c(2.5, 0.2))
df.density
get_legend<-function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
scan.graphs.wednesday <- list(g.scan.9.11, g.scan.9.18, g.scan.9.25)
skip.graphs.wednesday <- list(g.skip.9.11, g.skip.9.18, g.skip.9.25, g.skip.10.9)
scan.graphs.monday <- list(g.scan.9.16, g.scan.9.30)
df.density <- rbind(df.create(scan.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2),  week = c(1, 2, 1), method = 1),
df.create(skip.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2, 2), week = c(1, 2, 1, 2), method = 2),
df.create(scan.graphs.monday, session = 'Monday',
lab = c(1, 2), week = c(1, 1), method = 1)) %>%
mutate(lab.week = paste('L', lab, 'W', week, sep = ''),
method.session = paste('M', method, 'L', session)) %>%
melt(., measure.vars = c('density', 'density.weighted'))
plot.unweight <- ggplot(df.density %>%
filter(variable == 'density'),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
labs(x = 'Lab week', y = 'Unweighted Density') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00')) +
scale_shape_manual(name = 'Lab Number', values = c(16, 15)) +
theme(legend.position = "none")
plot.weight <- ggplot(df.density %>%
filter(variable == 'density.weighted') %>%
mutate(method = ifelse(method == 1, 'one', 'two')),
aes(x = as.factor(week), y = value, group = method,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
facet_wrap(~method, scales = 'free', nrow = 2, strip.position = "left",
labeller = as_labeller(c(one = "Weighted density (minutes)",
two = "Weighted density (count)"))) +
#facet_wrap(~variable, scales = 'free',
#labeller = labeller(variable = c('density' = 'Unweighted',
#'density.weighted' = 'Weighted'))) +
labs(x = 'Lab week') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00'),
labels = c('Scan', 'Skip')) +
scale_shape_manual(name = 'Lab session', values = c(16, 15)) +
theme(
strip.background = element_blank(),
#strip.text.x = element_blank()
strip.placement = "outside"
) +
ylab(NULL) +
theme(legend.position = "bottom")
legend <- get_legend(plot.weight)
plot.weight <- plot.weight + theme(legend.position = "none")
grid.arrange(plot.unweight, plot.weight, legend, layout_matrix = rbind(c(1, 2), c(3, 3)),
widths = c(2.7, 2.7), heights = c(2.5, 0.2))
get_legend<-function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
scan.graphs.wednesday <- list(g.scan.9.11, g.scan.9.18, g.scan.9.25)
skip.graphs.wednesday <- list(g.skip.9.11, g.skip.9.18, g.skip.9.25, g.skip.10.9)
scan.graphs.monday <- list(g.scan.9.16, g.scan.9.30)
df.density <- rbind(df.create(scan.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2),  week = c(1, 2, 1), method = 1),
df.create(skip.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2, 2), week = c(1, 2, 1, 2), method = 2),
df.create(scan.graphs.monday, session = 'Monday',
lab = c(1, 2), week = c(1, 1), method = 1)) %>%
mutate(lab.week = paste('L', lab, 'W', week, sep = ''),
method.session = paste('M', method, 'L', session)) %>%
melt(., measure.vars = c('density', 'density.weighted'))
plot.unweight <- ggplot(df.density %>%
filter(variable == 'density'),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
labs(x = 'Lab week', y = 'Unweighted Density') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00')) +
scale_shape_manual(name = 'Lab Number', values = c(16, 15)) +
theme(legend.position = "none")
plot.weight <- ggplot(df.density %>%
filter(variable == 'density.weighted') %>%
mutate(method = ifelse(method == 1, 'one', 'two')),
aes(x = as.factor(lab.week), y = value, group = method,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
facet_wrap(~method, scales = 'free', nrow = 2, strip.position = "left",
labeller = as_labeller(c(one = "Weighted density (minutes)",
two = "Weighted density (count)"))) +
#facet_wrap(~variable, scales = 'free',
#labeller = labeller(variable = c('density' = 'Unweighted',
#'density.weighted' = 'Weighted'))) +
labs(x = 'Lab week') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00'),
labels = c('Scan', 'Skip')) +
scale_shape_manual(name = 'Lab session', values = c(16, 15)) +
theme(
strip.background = element_blank(),
#strip.text.x = element_blank()
strip.placement = "outside"
) +
ylab(NULL) +
theme(legend.position = "bottom")
legend <- get_legend(plot.weight)
plot.weight <- plot.weight + theme(legend.position = "none")
grid.arrange(plot.unweight, plot.weight, legend, layout_matrix = rbind(c(1, 2), c(3, 3)),
widths = c(2.7, 2.7), heights = c(2.5, 0.2))
get_legend<-function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
scan.graphs.wednesday <- list(g.scan.9.11, g.scan.9.18, g.scan.9.25)
skip.graphs.wednesday <- list(g.skip.9.11, g.skip.9.18, g.skip.9.25, g.skip.10.9)
scan.graphs.monday <- list(g.scan.9.16, g.scan.9.30)
df.density <- rbind(df.create(scan.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2),  week = c(1, 2, 1), method = 1),
df.create(skip.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2, 2), week = c(1, 2, 1, 2), method = 2),
df.create(scan.graphs.monday, session = 'Monday',
lab = c(1, 2), week = c(1, 1), method = 1)) %>%
mutate(lab.week = paste('L', lab, 'W', week, sep = ''),
method.session = paste('M', method, 'L', session)) %>%
melt(., measure.vars = c('density', 'density.weighted'))
plot.unweight <- ggplot(df.density %>%
filter(variable == 'density'),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
labs(x = 'Lab week', y = 'Unweighted Density') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00')) +
scale_shape_manual(name = 'Lab Number', values = c(16, 15)) +
theme(legend.position = "none")
plot.weight <- ggplot(df.density %>%
filter(variable == 'density.weighted') %>%
mutate(method = ifelse(method == 1, 'one', 'two')),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
facet_wrap(~method, scales = 'free', nrow = 2, strip.position = "left",
labeller = as_labeller(c(one = "Weighted density (minutes)",
two = "Weighted density (count)"))) +
#facet_wrap(~variable, scales = 'free',
#labeller = labeller(variable = c('density' = 'Unweighted',
#'density.weighted' = 'Weighted'))) +
labs(x = 'Lab week') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00'),
labels = c('Scan', 'Skip')) +
scale_shape_manual(name = 'Lab session', values = c(16, 15)) +
theme(
strip.background = element_blank(),
#strip.text.x = element_blank()
strip.placement = "outside"
) +
ylab(NULL) +
theme(legend.position = "bottom")
legend <- get_legend(plot.weight)
plot.weight <- plot.weight + theme(legend.position = "none")
grid.arrange(plot.unweight, plot.weight, legend, layout_matrix = rbind(c(1, 2), c(3, 3)),
widths = c(2.7, 2.7), heights = c(2.5, 0.2))
get_legend<-function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
scan.graphs.wednesday <- list(g.scan.9.11, g.scan.9.18, g.scan.9.25)
skip.graphs.wednesday <- list(g.skip.9.11, g.skip.9.18, g.skip.9.25, g.skip.10.9)
scan.graphs.monday <- list(g.scan.9.16, g.scan.9.30)
df.density <- rbind(df.create(scan.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2),  week = c(1, 2, 1), method = 1),
df.create(skip.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2, 2), week = c(1, 2, 1, 2), method = 2),
df.create(scan.graphs.monday, session = 'Monday',
lab = c(1, 2), week = c(1, 1), method = 1)) %>%
mutate(lab.week = paste('L', lab, 'W', week, sep = ''),
method.session = paste('M', method, 'L', session)) %>%
melt(., measure.vars = c('density', 'density.weighted'))
plot.unweight <- ggplot(df.density %>%
filter(variable == 'density'),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
labs(x = 'Lab week', y = 'Unweighted Density') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00')) +
scale_shape_manual(name = 'Lab Number', values = c(16, 15), values = c('A', 'B')) +
theme(legend.position = "none")
get_legend<-function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
scan.graphs.wednesday <- list(g.scan.9.11, g.scan.9.18, g.scan.9.25)
skip.graphs.wednesday <- list(g.skip.9.11, g.skip.9.18, g.skip.9.25, g.skip.10.9)
scan.graphs.monday <- list(g.scan.9.16, g.scan.9.30)
df.density <- rbind(df.create(scan.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2),  week = c(1, 2, 1), method = 1),
df.create(skip.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2, 2), week = c(1, 2, 1, 2), method = 2),
df.create(scan.graphs.monday, session = 'Monday',
lab = c(1, 2), week = c(1, 1), method = 1)) %>%
mutate(lab.week = paste('L', lab, 'W', week, sep = ''),
method.session = paste('M', method, 'L', session)) %>%
melt(., measure.vars = c('density', 'density.weighted'))
plot.unweight <- ggplot(df.density %>%
filter(variable == 'density'),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
labs(x = 'Lab week', y = 'Unweighted Density') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00')) +
scale_shape_manual(name = 'Lab Number', values = c(16, 15), labels = c('A', 'B')) +
theme(legend.position = "none")
plot.weight <- ggplot(df.density %>%
filter(variable == 'density.weighted') %>%
mutate(method = ifelse(method == 1, 'one', 'two')),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
facet_wrap(~method, scales = 'free', nrow = 2, strip.position = "left",
labeller = as_labeller(c(one = "Weighted density (minutes)",
two = "Weighted density (count)"))) +
#facet_wrap(~variable, scales = 'free',
#labeller = labeller(variable = c('density' = 'Unweighted',
#'density.weighted' = 'Weighted'))) +
labs(x = 'Lab week') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00'),
labels = c('Scan', 'Skip')) +
scale_shape_manual(name = 'Lab session', values = c(16, 15)) +
theme(
strip.background = element_blank(),
#strip.text.x = element_blank()
strip.placement = "outside"
) +
ylab(NULL) +
theme(legend.position = "bottom")
legend <- get_legend(plot.weight)
plot.weight <- plot.weight + theme(legend.position = "none")
grid.arrange(plot.unweight, plot.weight, legend, layout_matrix = rbind(c(1, 2), c(3, 3)),
widths = c(2.7, 2.7), heights = c(2.5, 0.2))
get_legend<-function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
scan.graphs.wednesday <- list(g.scan.9.11, g.scan.9.18, g.scan.9.25)
skip.graphs.wednesday <- list(g.skip.9.11, g.skip.9.18, g.skip.9.25, g.skip.10.9)
scan.graphs.monday <- list(g.scan.9.16, g.scan.9.30)
df.density <- rbind(df.create(scan.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2),  week = c(1, 2, 1), method = 1),
df.create(skip.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2, 2), week = c(1, 2, 1, 2), method = 2),
df.create(scan.graphs.monday, session = 'Monday',
lab = c(1, 2), week = c(1, 1), method = 1)) %>%
mutate(lab.week = paste('L', lab, 'W', week, sep = ''),
method.session = paste('M', method, 'L', session)) %>%
melt(., measure.vars = c('density', 'density.weighted'))
plot.unweight <- ggplot(df.density %>%
filter(variable == 'density'),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = session) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
labs(x = 'Lab week', y = 'Unweighted Density') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00')) +
scale_shape_manual(name = 'Lab Number', values = c(16, 15)) +
theme(legend.position = "none")
plot.weight <- ggplot(df.density %>%
filter(variable == 'density.weighted') %>%
mutate(method = ifelse(method == 1, 'one', 'two')),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
facet_wrap(~method, scales = 'free', nrow = 2, strip.position = "left",
labeller = as_labeller(c(one = "Weighted density (minutes)",
two = "Weighted density (count)"))) +
#facet_wrap(~variable, scales = 'free',
#labeller = labeller(variable = c('density' = 'Unweighted',
#'density.weighted' = 'Weighted'))) +
labs(x = 'Lab week') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00'),
labels = c('Scan', 'Skip')) +
scale_shape_manual(name = 'Lab session', values = c(16, 15)) +
theme(
strip.background = element_blank(),
#strip.text.x = element_blank()
strip.placement = "outside"
) +
ylab(NULL) +
theme(legend.position = "bottom")
legend <- get_legend(plot.weight)
plot.weight <- plot.weight + theme(legend.position = "none")
grid.arrange(plot.unweight, plot.weight, legend, layout_matrix = rbind(c(1, 2), c(3, 3)),
widths = c(2.7, 2.7), heights = c(2.5, 0.2))
get_legend<-function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
scan.graphs.wednesday <- list(g.scan.9.11, g.scan.9.18, g.scan.9.25)
skip.graphs.wednesday <- list(g.skip.9.11, g.skip.9.18, g.skip.9.25, g.skip.10.9)
scan.graphs.monday <- list(g.scan.9.16, g.scan.9.30)
df.density <- rbind(df.create(scan.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2),  week = c(1, 2, 1), method = 1),
df.create(skip.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2, 2), week = c(1, 2, 1, 2), method = 2),
df.create(scan.graphs.monday, session = 'Monday',
lab = c(1, 2), week = c(1, 1), method = 1)) %>%
mutate(lab.week = paste('L', lab, 'W', week, sep = ''),
method.session = paste('M', method, 'L', session)) %>%
melt(., measure.vars = c('density', 'density.weighted'))
plot.unweight <- ggplot(df.density %>%
filter(variable == 'density'),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = method.session) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
labs(x = 'Lab week', y = 'Unweighted Density') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00')) +
scale_shape_manual(name = 'Lab Number', values = c(16, 15)) +
theme(legend.position = "none")
plot.weight <- ggplot(df.density %>%
filter(variable == 'density.weighted') %>%
mutate(method = ifelse(method == 1, 'one', 'two')),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
facet_wrap(~method, scales = 'free', nrow = 2, strip.position = "left",
labeller = as_labeller(c(one = "Weighted density (minutes)",
two = "Weighted density (count)"))) +
#facet_wrap(~variable, scales = 'free',
#labeller = labeller(variable = c('density' = 'Unweighted',
#'density.weighted' = 'Weighted'))) +
labs(x = 'Lab week') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00'),
labels = c('Scan', 'Skip')) +
scale_shape_manual(name = 'Lab session', values = c(16, 15)) +
theme(
strip.background = element_blank(),
#strip.text.x = element_blank()
strip.placement = "outside"
) +
ylab(NULL) +
theme(legend.position = "bottom")
legend <- get_legend(plot.weight)
plot.weight <- plot.weight + theme(legend.position = "none")
grid.arrange(plot.unweight, plot.weight, legend, layout_matrix = rbind(c(1, 2), c(3, 3)),
widths = c(2.7, 2.7), heights = c(2.5, 0.2))
get_legend<-function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
scan.graphs.wednesday <- list(g.scan.9.11, g.scan.9.18, g.scan.9.25)
skip.graphs.wednesday <- list(g.skip.9.11, g.skip.9.18, g.skip.9.25, g.skip.10.9)
scan.graphs.monday <- list(g.scan.9.16, g.scan.9.30)
df.density <- rbind(df.create(scan.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2),  week = c(1, 2, 1), method = 1),
df.create(skip.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2, 2), week = c(1, 2, 1, 2), method = 2),
df.create(scan.graphs.monday, session = 'Monday',
lab = c(1, 2), week = c(1, 1), method = 1)) %>%
mutate(lab.week = paste('L', lab, 'W', week, sep = ''),
method.session = paste('M', method, 'L', session)) %>%
melt(., measure.vars = c('density', 'density.weighted'))
plot.unweight <- ggplot(df.density %>%
filter(variable == 'density'),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method))) +
geom_point(size = 4, aes(shape = session)) +
geom_line(stat = 'identity', size = 1) +
labs(x = 'Lab week', y = 'Unweighted Density') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00')) +
scale_shape_manual(name = 'Lab Number', values = c(16, 15)) +
theme(legend.position = "none")
plot.weight <- ggplot(df.density %>%
filter(variable == 'density.weighted') %>%
mutate(method = ifelse(method == 1, 'one', 'two')),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4) +
geom_line(stat = 'identity', size = 1) +
facet_wrap(~method, scales = 'free', nrow = 2, strip.position = "left",
labeller = as_labeller(c(one = "Weighted density (minutes)",
two = "Weighted density (count)"))) +
#facet_wrap(~variable, scales = 'free',
#labeller = labeller(variable = c('density' = 'Unweighted',
#'density.weighted' = 'Weighted'))) +
labs(x = 'Lab week') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00'),
labels = c('Scan', 'Skip')) +
scale_shape_manual(name = 'Lab session', values = c(16, 15)) +
theme(
strip.background = element_blank(),
#strip.text.x = element_blank()
strip.placement = "outside"
) +
ylab(NULL) +
theme(legend.position = "bottom")
legend <- get_legend(plot.weight)
plot.weight <- plot.weight + theme(legend.position = "none")
grid.arrange(plot.unweight, plot.weight, legend, layout_matrix = rbind(c(1, 2), c(3, 3)),
widths = c(2.7, 2.7), heights = c(2.5, 0.2))
get_legend<-function(myggplot){
tmp <- ggplot_gtable(ggplot_build(myggplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)
}
scan.graphs.wednesday <- list(g.scan.9.11, g.scan.9.18, g.scan.9.25)
skip.graphs.wednesday <- list(g.skip.9.11, g.skip.9.18, g.skip.9.25, g.skip.10.9)
scan.graphs.monday <- list(g.scan.9.16, g.scan.9.30)
df.density <- rbind(df.create(scan.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2),  week = c(1, 2, 1), method = 1),
df.create(skip.graphs.wednesday, session = 'Wednesday',
lab = c(1, 1, 2, 2), week = c(1, 2, 1, 2), method = 2),
df.create(scan.graphs.monday, session = 'Monday',
lab = c(1, 2), week = c(1, 1), method = 1)) %>%
mutate(lab.week = paste('L', lab, 'W', week, sep = ''),
method.session = paste('M', method, 'L', session)) %>%
melt(., measure.vars = c('density', 'density.weighted'))
plot.unweight <- ggplot(df.density %>%
filter(variable == 'density'),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method))) +
geom_point(size = 4, aes(shape = session)) +
geom_line(stat = 'identity', size = 1) +
labs(x = 'Lab week', y = 'Unweighted Density') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00')) +
scale_shape_manual(name = 'Lab Number', values = c(16, 15)) +
theme(legend.position = "none")
plot.weight <- ggplot(df.density %>%
filter(variable == 'density.weighted') %>%
mutate(method = ifelse(method == 1, 'one', 'two')),
aes(x = as.factor(lab.week), y = value, group = method.session,
color = as.factor(method)), shape = as.factor(session)) +
geom_point(size = 4, aes(shape = session)) +
geom_line(stat = 'identity', size = 1) +
facet_wrap(~method, scales = 'free', nrow = 2, strip.position = "left",
labeller = as_labeller(c(one = "Weighted density (minutes)",
two = "Weighted density (count)"))) +
#facet_wrap(~variable, scales = 'free',
#labeller = labeller(variable = c('density' = 'Unweighted',
#'density.weighted' = 'Weighted'))) +
labs(x = 'Lab week') +
scale_color_manual(name = 'Method', values = c('#0072B2', '#E69F00'),
labels = c('Scan', 'Skip')) +
scale_shape_manual(name = 'Lab session', values = c(16, 15)) +
theme(
strip.background = element_blank(),
#strip.text.x = element_blank()
strip.placement = "outside"
) +
ylab(NULL) +
theme(legend.position = "bottom")
legend <- get_legend(plot.weight)
plot.weight <- plot.weight + theme(legend.position = "none")
grid.arrange(plot.unweight, plot.weight, legend, layout_matrix = rbind(c(1, 2), c(3, 3)),
widths = c(2.7, 2.7), heights = c(2.5, 0.2))
g.skip.9.11 <- graph.from.adjacency('C:/Users/Cole/Box Sync/Network analysis/Adjacency_Matrices/P1112_Fall2019/Skip_Method/Skip_9_11_DK.csv',
name = '9-11 Skip')
plot.graph(g.skip.9.11)
g.skip.9.18 <- graph.from.adjacency('C:/Users/Cole/Box Sync/Network analysis/Adjacency_Matrices/P1112_Fall2019/Skip_Method/Skip_9_18_DK.csv',
name = '9-28 Skip')
V(g.skip.9.18)$name <- c('1A', '1B', '2C', '2B', '2A', '3A', '3C', '3B', '4A', '4B', '4C',
'5A', '5B', '5C', '6A', '6B', '6C', '7A', '7B')
plot.graph(g.skip.9.18)
g.skip.9.25 = create.graph(file1 = 'C:/Users/Cole/Box Sync/Network analysis/Exported_Data/P1112_Fall2019/Skip_Method/Skip_9_25_cam1_CW.csv',
file2 = 'C:/Users/Cole/Box Sync/Network analysis/Exported_Data/P1112_Fall2019/Skip_Method/Skip_9_25_cam2_CW.csv',
nvid1 = 1, nvid2 = 1, method = 2, name = '9-25 Skip')
plot.graph(g.skip.9.25)
g.skip.10.9 <- graph.from.adjacency('C:/Users/Cole/Box Sync/Network analysis/Adjacency_Matrices/P1112_Fall2019/Skip_Method/Skip_10_9_DK.csv',
name = '10-9 Skip')
plot.graph(g.skip.10.9)
